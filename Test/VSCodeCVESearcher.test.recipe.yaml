Description: Test the StringManipulatorProcessor
Identifier: com.github.iancohn.test.VSCodeCVESearcher
MinimumVersion: "2.3"

Input:
  VSCODE_URL: https://code.visualstudio.com/updates/v1_91

Process:
  -
    Processor: URLTextSearcher
    Arguments:
      url: "%VSCODE_URL%"
      re_pattern: '[\s\S]*'
  - 
    Processor: com.github.iancohn.SharedProcessors/StringManipulator
    Arguments:
      manipulation_actions:
        -
          input_variable_name: match
          action_type: simple_match
          output_variable_name: match
          options: 
            re_pattern: 'cve\-\d{4}\-\d*'
            re_flags: IGNORECASE
            find_all: True
        -
          input_variable_name: match
          action_type: concatenate
          #output_variable_name: concatenatedOutput
          options:
            concatenate_with_text: ","
  - 
    Processor: com.github.iancohn.SharedProcessors/CVEScoreGetter
    Arguments:
      cves: "%output%"
      #null_cve_rating: Null